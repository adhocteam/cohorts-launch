- modalId = "#{action}-client-#{client.id.to_s + '-' unless action == 'create'}modal"
- formId = "#{action}-client-#{client.id.to_s + '-' unless action == 'create'}form"
.ui.modal{ id: modalId }
  .header= "#{action.capitalize} Client"
  .content
    - if action == 'show'
      %h4.ui.header Engagements
      %table.ui.sortable.striped.table
        %thead
          %tr
            %th Topic
            %th Sessions
            %th Start date
            %th End date
        %tbody
          - client.engagements.each do |engagement|
            %tr
              %td= engagement.topic
              %td= engagement.research_sessions&.count || 0
              %td= engagement.start_date
              %td= engagement.end_date
    - elsif action == 'destroy'
      = form_for client, method: :delete, format: :js, remote: true, html: { class: 'ui form', id: formId } do |f|
        %p Are you sure? This will delete the client along with all engagements.
    - else
      = form_for client, format: :js, remote: true, html: { class: 'ui form', id: formId } do |f|
        = f.label :name
        = f.text_field :name
  .actions
    - unless action == 'show'
      %input.ui.button{ class: action == 'destroy' ? 'negative' : 'positive', type: 'submit', value: action.capitalize, form: formId }
    .ui.cancel.button Close
